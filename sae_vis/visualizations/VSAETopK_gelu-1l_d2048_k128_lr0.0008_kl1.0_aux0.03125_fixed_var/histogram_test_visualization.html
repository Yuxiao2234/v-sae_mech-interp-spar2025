
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAE Feature Visualization</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .controls {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        #feature-select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            min-width: 200px;
        }
        
        #feature-count {
            color: #666;
            font-size: 14px;
        }
        
        main {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .feature-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 6px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .section h2 {
            color: #34495e;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #3498db;
        }
        
        .histograms-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .histogram-container {
            background: #fafafa;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            padding: 15px;
        }
        
        .histogram-container h3 {
            margin-bottom: 10px;
            color: #2c3e50;
            font-size: 16px;
        }
        
        .histogram {
            width: 100%;
            height: 300px;
        }
        
        .examples-grid {
            display: grid;
            gap: 15px;
        }
        
        .example {
            padding: 15px;
            border: 1px solid #e1e8ed;
            border-radius: 6px;
            background: #fafafa;
        }
        
        .example-header {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .token-sequence {
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 14px;
            line-height: 1.8;
            word-wrap: break-word;
        }
        
        .token {
            display: inline-block;
            padding: 2px 4px;
            margin: 1px;
            border-radius: 3px;
            border: 1px solid transparent;
        }
        
        .token.active {
            background-color: #3498db;
            color: white;
            border-color: #2980b9;
        }
        
        .token.medium {
            background-color: #85c1e9;
            color: #2c3e50;
            border-color: #5dade2;
        }
        
        .token.low {
            background-color: #d6eaf8;
            color: #2c3e50;
            border-color: #aed6f1;
        }
        
        .logits-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .logits-column h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .boosted h3 {
            color: #27ae60;
        }
        
        .suppressed h3 {
            color: #e74c3c;
        }
        
        .token-list {
            list-style: none;
        }
        
        .token-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin: 2px 0;
            background: #f8f9fa;
            border-radius: 4px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 13px;
        }
        
        .boosted .token-list li {
            border-left: 3px solid #27ae60;
        }
        
        .suppressed .token-list li {
            border-left: 3px solid #e74c3c;
        }
        
        .token-effect {
            font-weight: bold;
            font-size: 12px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        @media (max-width: 1200px) {
            .histograms-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            #feature-select {
                min-width: auto;
            }
            
            .logits-grid {
                grid-template-columns: 1fr;
            }
            
            .feature-stats {
                grid-template-columns: 1fr 1fr;
            }
        }
        
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SAE Feature Visualization</h1>
            <div class="controls">
                <label for="feature-select">Feature:</label>
                <select id="feature-select">
                    <option value="0">Feature 0 (sparsity: 0.935)</option>
<option value="1">Feature 1 (sparsity: 1.000)</option>
<option value="5">Feature 5 (sparsity: 1.000)</option>
<option value="10">Feature 10 (sparsity: 1.000)</option>
<option value="25">Feature 25 (sparsity: 1.000)</option>
                </select>
                <span id="feature-count">5 features total</span>
            </div>
        </header>
        
        <main id="feature-content">
            <div class="loading">Loading feature data...</div>
        </main>
    </div>
    
    <script>
        const FEATURE_DATA = {
  "0": {
    "feature_idx": 0,
    "sparsity": 0.9351351351351351,
    "mean_activation": 1.0346537133057911,
    "max_activation": 1.4952843189239502,
    "decoder_norm": 1.9801077842712402,
    "top_examples": [
      {
        "text": "The quick brown fox jumps over the lazy dog.",
        "tokens": [
          "The",
          " quick",
          " brown",
          " fox",
          " jumps",
          " over",
          " the",
          " lazy",
          " dog",
          "."
        ],
        "activations": [
          1.4952843189239502,
          1.2963175773620605,
          0.7991535663604736,
          0.0,
          0.8625742793083191,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_activation": 1.4952843189239502,
        "seq_pos": 0
      },
      {
        "text": "The weather today is sunny and warm with temperatures of 25\u00b0C.",
        "tokens": [
          "The",
          " weather",
          " today",
          " is",
          " sunny",
          " and",
          " warm",
          " with",
          " temperatures",
          " of",
          " 2",
          "5",
          "\u00b0",
          "C",
          "."
        ],
        "activations": [
          1.495283842086792,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.9110425114631653,
          0.8416888117790222,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_activation": 1.495283842086792,
        "seq_pos": 0
      },
      {
        "text": "The quick brown fox jumps over the lazy dog.",
        "tokens": [
          "The",
          " quick",
          " brown",
          " fox",
          " jumps",
          " over",
          " the",
          " lazy",
          " dog",
          "."
        ],
        "activations": [
          1.4952843189239502,
          1.2963175773620605,
          0.7991535663604736,
          0.0,
          0.8625742793083191,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_activation": 1.2963175773620605,
        "seq_pos": 1
      },
      {
        "text": "for i in range(10):\n    print(f'Hello {i}')\n    time.sleep(1)",
        "tokens": [
          "for",
          " i",
          " in",
          " range",
          "(",
          "1",
          "0",
          "):",
          "\n   ",
          " print",
          "(",
          "f",
          "'",
          "Hello",
          " {",
          "i",
          "}",
          "')",
          "\n   ",
          " time",
          ".",
          "sleep",
          "(",
          "1",
          ")"
        ],
        "activations": [
          0.0,
          0.0,
          0.0,
          0.9407381415367126,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          -0.751643717288971,
          0.0,
          -0.7359018921852112,
          1.1156182289123535,
          0.0,
          -0.8567605018615723,
          0.8568601608276367,
          0.0,
          1.045433521270752,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_activation": 1.1156182289123535,
        "seq_pos": 13
      },
      {
        "text": "for i in range(10):\n    print(f'Hello {i}')\n    time.sleep(1)",
        "tokens": [
          "for",
          " i",
          " in",
          " range",
          "(",
          "1",
          "0",
          "):",
          "\n   ",
          " print",
          "(",
          "f",
          "'",
          "Hello",
          " {",
          "i",
          "}",
          "')",
          "\n   ",
          " time",
          ".",
          "sleep",
          "(",
          "1",
          ")"
        ],
        "activations": [
          0.0,
          0.0,
          0.0,
          0.9407381415367126,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          -0.751643717288971,
          0.0,
          -0.7359018921852112,
          1.1156182289123535,
          0.0,
          -0.8567605018615723,
          0.8568601608276367,
          0.0,
          1.045433521270752,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_activation": 1.045433521270752,
        "seq_pos": 18
      },
      {
        "text": "for i in range(10):\n    print(f'Hello {i}')\n    time.sleep(1)",
        "tokens": [
          "for",
          " i",
          " in",
          " range",
          "(",
          "1",
          "0",
          "):",
          "\n   ",
          " print",
          "(",
          "f",
          "'",
          "Hello",
          " {",
          "i",
          "}",
          "')",
          "\n   ",
          " time",
          ".",
          "sleep",
          "(",
          "1",
          ")"
        ],
        "activations": [
          0.0,
          0.0,
          0.0,
          0.9407381415367126,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          -0.751643717288971,
          0.0,
          -0.7359018921852112,
          1.1156182289123535,
          0.0,
          -0.8567605018615723,
          0.8568601608276367,
          0.0,
          1.045433521270752,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_activation": 0.9407381415367126,
        "seq_pos": 3
      },
      {
        "text": "The weather today is sunny and warm with temperatures of 25\u00b0C.",
        "tokens": [
          "The",
          " weather",
          " today",
          " is",
          " sunny",
          " and",
          " warm",
          " with",
          " temperatures",
          " of",
          " 2",
          "5",
          "\u00b0",
          "C",
          "."
        ],
        "activations": [
          1.495283842086792,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.9110425114631653,
          0.8416888117790222,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_activation": 0.9110425114631653,
        "seq_pos": 6
      },
      {
        "text": "The quick brown fox jumps over the lazy dog.",
        "tokens": [
          "The",
          " quick",
          " brown",
          " fox",
          " jumps",
          " over",
          " the",
          " lazy",
          " dog",
          "."
        ],
        "activations": [
          1.4952843189239502,
          1.2963175773620605,
          0.7991535663604736,
          0.0,
          0.8625742793083191,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_activation": 0.8625742793083191,
        "seq_pos": 4
      },
      {
        "text": "for i in range(10):\n    print(f'Hello {i}')\n    time.sleep(1)",
        "tokens": [
          "for",
          " i",
          " in",
          " range",
          "(",
          "1",
          "0",
          "):",
          "\n   ",
          " print",
          "(",
          "f",
          "'",
          "Hello",
          " {",
          "i",
          "}",
          "')",
          "\n   ",
          " time",
          ".",
          "sleep",
          "(",
          "1",
          ")"
        ],
        "activations": [
          0.0,
          0.0,
          0.0,
          0.9407381415367126,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          -0.751643717288971,
          0.0,
          -0.7359018921852112,
          1.1156182289123535,
          0.0,
          -0.8567605018615723,
          0.8568601608276367,
          0.0,
          1.045433521270752,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_activation": 0.8568601608276367,
        "seq_pos": 16
      },
      {
        "text": "The weather today is sunny and warm with temperatures of 25\u00b0C.",
        "tokens": [
          "The",
          " weather",
          " today",
          " is",
          " sunny",
          " and",
          " warm",
          " with",
          " temperatures",
          " of",
          " 2",
          "5",
          "\u00b0",
          "C",
          "."
        ],
        "activations": [
          1.495283842086792,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.9110425114631653,
          0.8416888117790222,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_activation": 0.8416888117790222,
        "seq_pos": 7
      },
      {
        "text": "The quick brown fox jumps over the lazy dog.",
        "tokens": [
          "The",
          " quick",
          " brown",
          " fox",
          " jumps",
          " over",
          " the",
          " lazy",
          " dog",
          "."
        ],
        "activations": [
          1.4952843189239502,
          1.2963175773620605,
          0.7991535663604736,
          0.0,
          0.8625742793083191,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0
        ],
        "max_activation": 0.7991535663604736,
        "seq_pos": 2
      },
      {
        "text": "import torch\nimport numpy as np\nfrom transformer_lens import HookedTransformer",
        "tokens": [
          "import",
          " torch",
          "\n",
          "import",
          " numpy",
          " as",
          " np",
          "\n",
          "from",
          " transformer",
          "_",
          "lens",
          " import",
          " Hook",
          "ed",
          "Trans",
          "former"
        ],
        "activations": [
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.0,
          0.7558495998382568
        ],
        "max_activation": 0.7558495998382568,
        "seq_pos": 16
      }
    ],
    "top_boosted_tokens": [
      [
        "azole",
        1.6636613607406616
      ],
      [
        "ney",
        1.5083743333816528
      ],
      [
        " envy",
        1.5028679370880127
      ],
      [
        "sexual",
        1.462300181388855
      ],
      [
        "neys",
        1.449639081954956
      ],
      [
        "Lem",
        1.4493935108184814
      ],
      [
        "sey",
        1.4458945989608765
      ],
      [
        " intention",
        1.4413745403289795
      ],
      [
        "died",
        1.4375920295715332
      ],
      [
        "scar",
        1.4226006269454956
      ]
    ],
    "top_suppressed_tokens": [
      [
        "\"?",
        -2.207258701324463
      ],
      [
        ",\"",
        -2.2068543434143066
      ],
      [
        "!\"",
        -2.055511474609375
      ],
      [
        " !\"",
        -1.9387919902801514
      ],
      [
        ",'\"",
        -1.9144413471221924
      ],
      [
        "?\",",
        -1.904686689376831
      ],
      [
        "!\\",
        -1.8775261640548706
      ],
      [
        ")\",",
        -1.8276891708374023
      ],
      [
        ",''",
        -1.8235230445861816
      ],
      [
        "!\u201d",
        -1.7669621706008911
      ]
    ],
    "activation_histogram": {
      "bin_edges": [
        0.7558495998382568,
        0.805145247777303,
        0.8544408957163493,
        0.9037365436553955,
        0.9530321915944417,
        1.002327839533488,
        1.051623487472534,
        1.1009191354115804,
        1.1502147833506267,
        1.199510431289673,
        1.248806079228719,
        1.2981017271677653,
        1.3473973751068113,
        1.3966930230458576,
        1.445988670984904,
        1.4952843189239502
      ],
      "bar_heights": [
        2,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        0,
        0,
        2
      ],
      "title": "Histogram of randomly sampled non-zero activations",
      "x_label": "Activation Value",
      "y_label": "Count"
    },
    "logit_histogram": {
      "bin_edges": [
        -2.207258701324463,
        -1.8201666951179505,
        -1.433074688911438,
        -1.0459826827049254,
        -0.658890676498413,
        -0.27179867029190063,
        0.115293335914612,
        0.5023853421211242,
        0.8894773483276368,
        1.2765693545341494,
        1.6636613607406616
      ],
      "bar_heights": [
        9,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        10
      ],
      "title": "Top 10 negative and positive output logits",
      "x_label": "Logit Effect",
      "y_label": "Count"
    }
  },
  "1": {
    "feature_idx": 1,
    "sparsity": 1.0,
    "mean_activation": 0.0,
    "max_activation": 0.0,
    "decoder_norm": 1.9874190092086792,
    "top_examples": [],
    "top_boosted_tokens": [
      [
        "ibles",
        2.2152087688446045
      ],
      [
        "ency",
        2.183682918548584
      ],
      [
        "etype",
        2.1662089824676514
      ],
      [
        "able",
        2.159548044204712
      ],
      [
        "ible",
        2.1534433364868164
      ],
      [
        "etime",
        2.0789012908935547
      ],
      [
        "ership",
        2.0695767402648926
      ],
      [
        "term",
        2.0235140323638916
      ],
      [
        "len",
        1.9902160167694092
      ],
      [
        "or",
        1.9901751279830933
      ]
    ],
    "top_suppressed_tokens": [
      [
        "\n",
        -1.961320400238037
      ],
      [
        "\n \n",
        -1.94913911819458
      ],
      [
        "\n\n\n\n\n",
        -1.8938558101654053
      ],
      [
        " \n  ",
        -1.8611888885498047
      ],
      [
        "\n ",
        -1.8530535697937012
      ],
      [
        " (),",
        -1.8401731252670288
      ],
      [
        "<|EOS|>",
        -1.8316236734390259
      ],
      [
        "\r\n",
        -1.8262226581573486
      ],
      [
        "\n\n    ",
        -1.8179337978363037
      ],
      [
        "\n\t\n",
        -1.7818522453308105
      ]
    ],
    "activation_histogram": {
      "bin_edges": [
        0,
        1
      ],
      "bar_heights": [
        0
      ],
      "title": "Histogram of randomly sampled non-zero activations",
      "x_label": "Activation Value",
      "y_label": "Count"
    },
    "logit_histogram": {
      "bin_edges": [
        -1.961320400238037,
        -1.543667483329773,
        -1.1260145664215089,
        -0.7083616495132445,
        -0.2907087326049804,
        0.1269441843032837,
        0.544597101211548,
        0.9622500181198119,
        1.3799029350280763,
        1.7975558519363406,
        2.2152087688446045
      ],
      "bar_heights": [
        10,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        10
      ],
      "title": "Top 10 negative and positive output logits",
      "x_label": "Logit Effect",
      "y_label": "Count"
    }
  },
  "5": {
    "feature_idx": 5,
    "sparsity": 1.0,
    "mean_activation": 0.0,
    "max_activation": 0.0,
    "decoder_norm": 1.9175958633422852,
    "top_examples": [],
    "top_boosted_tokens": [
      [
        " guessing",
        1.5554873943328857
      ],
      [
        " clicking",
        1.5513449907302856
      ],
      [
        "ring",
        1.4580440521240234
      ],
      [
        "?:",
        1.4412906169891357
      ],
      [
        " way",
        1.4203383922576904
      ],
      [
        " vain",
        1.4008338451385498
      ],
      [
        "sche",
        1.3797838687896729
      ],
      [
        "emon",
        1.3495560884475708
      ],
      [
        "ough",
        1.340754508972168
      ],
      [
        " selecting",
        1.3394750356674194
      ]
    ],
    "top_suppressed_tokens": [
      [
        "issance",
        -1.5394366979599
      ],
      [
        "iliary",
        -1.4882386922836304
      ],
      [
        "facial",
        -1.4490858316421509
      ],
      [
        "UIC",
        -1.4438819885253906
      ],
      [
        "ierno",
        -1.4427944421768188
      ],
      [
        "Changed",
        -1.4255874156951904
      ],
      [
        "amycin",
        -1.4024691581726074
      ],
      [
        "sembled",
        -1.3723546266555786
      ],
      [
        " processed",
        -1.3512775897979736
      ],
      [
        "FET",
        -1.3464828729629517
      ]
    ],
    "activation_histogram": {
      "bin_edges": [
        0,
        1
      ],
      "bar_heights": [
        0
      ],
      "title": "Histogram of randomly sampled non-zero activations",
      "x_label": "Activation Value",
      "y_label": "Count"
    },
    "logit_histogram": {
      "bin_edges": [
        -1.5394366979599,
        -1.2299442887306213,
        -0.9204518795013428,
        -0.6109594702720642,
        -0.30146706104278564,
        0.00802534818649292,
        0.3175177574157715,
        0.62701016664505,
        0.9365025758743286,
        1.2459949851036072,
        1.5554873943328857
      ],
      "bar_heights": [
        10,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        10
      ],
      "title": "Top 10 negative and positive output logits",
      "x_label": "Logit Effect",
      "y_label": "Count"
    }
  },
  "10": {
    "feature_idx": 10,
    "sparsity": 1.0,
    "mean_activation": 0.0,
    "max_activation": 0.0,
    "decoder_norm": 1.9960451126098633,
    "top_examples": [],
    "top_boosted_tokens": [
      [
        "argv",
        1.9193410873413086
      ],
      [
        "ains",
        1.8424959182739258
      ],
      [
        "IFIC",
        1.7530168294906616
      ],
      [
        "MENT",
        1.7049565315246582
      ],
      [
        "_:",
        1.6721739768981934
      ],
      [
        "earth",
        1.6185593605041504
      ],
      [
        "args",
        1.6040112972259521
      ],
      [
        "LU",
        1.592360258102417
      ],
      [
        "monton",
        1.590177059173584
      ],
      [
        "rea",
        1.5439062118530273
      ]
    ],
    "top_suppressed_tokens": [
      [
        " increments",
        -1.6437315940856934
      ],
      [
        " hips",
        -1.5233484506607056
      ],
      [
        "itional",
        -1.5041909217834473
      ],
      [
        " ourselves",
        -1.4888873100280762
      ],
      [
        " rotation",
        -1.48268723487854
      ],
      [
        " Conserv",
        -1.4406704902648926
      ],
      [
        "escent",
        -1.35577392578125
      ],
      [
        " enumerate",
        -1.320190668106079
      ],
      [
        "wart",
        -1.3182884454727173
      ],
      [
        " England",
        -1.301974892616272
      ]
    ],
    "activation_histogram": {
      "bin_edges": [
        0,
        1
      ],
      "bar_heights": [
        0
      ],
      "title": "Histogram of randomly sampled non-zero activations",
      "x_label": "Activation Value",
      "y_label": "Count"
    },
    "logit_histogram": {
      "bin_edges": [
        -1.6437315940856934,
        -1.2874243259429932,
        -0.931117057800293,
        -0.5748097896575928,
        -0.21850252151489258,
        0.13780474662780762,
        0.4941120147705078,
        0.850419282913208,
        1.2067265510559082,
        1.5630338191986084,
        1.9193410873413086
      ],
      "bar_heights": [
        10,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        9
      ],
      "title": "Top 10 negative and positive output logits",
      "x_label": "Logit Effect",
      "y_label": "Count"
    }
  },
  "25": {
    "feature_idx": 25,
    "sparsity": 1.0,
    "mean_activation": 0.0,
    "max_activation": 0.0,
    "decoder_norm": 2.0105602741241455,
    "top_examples": [],
    "top_boosted_tokens": [
      [
        "OTH",
        1.6387169361114502
      ],
      [
        "\u0159",
        1.6151161193847656
      ],
      [
        "INFO",
        1.5990381240844727
      ],
      [
        " McCoy",
        1.583045244216919
      ],
      [
        "TLS",
        1.5483317375183105
      ],
      [
        "Carl",
        1.5157792568206787
      ],
      [
        "ARS",
        1.5014716386795044
      ],
      [
        " Minn",
        1.463754415512085
      ],
      [
        "GROUP",
        1.4550158977508545
      ],
      [
        "AMES",
        1.4417072534561157
      ]
    ],
    "top_suppressed_tokens": [
      [
        " ),",
        -1.7430365085601807
      ],
      [
        "yahoo",
        -1.723514199256897
      ],
      [
        "inate",
        -1.601693868637085
      ],
      [
        " ))",
        -1.5748894214630127
      ],
      [
        " difference",
        -1.541081428527832
      ],
      [
        " theorem",
        -1.513242483139038
      ],
      [
        " omission",
        -1.5130221843719482
      ],
      [
        "\u0435\u0440",
        -1.5078697204589844
      ],
      [
        " plag",
        -1.4848954677581787
      ],
      [
        "\ufffd",
        -1.4546923637390137
      ]
    ],
    "activation_histogram": {
      "bin_edges": [
        0,
        1
      ],
      "bar_heights": [
        0
      ],
      "title": "Histogram of randomly sampled non-zero activations",
      "x_label": "Activation Value",
      "y_label": "Count"
    },
    "logit_histogram": {
      "bin_edges": [
        -1.7430365085601807,
        -1.4048611640930175,
        -1.0666858196258544,
        -0.7285104751586915,
        -0.39033513069152836,
        -0.052159786224365234,
        0.2860155582427977,
        0.624190902709961,
        0.9623662471771239,
        1.3005415916442868,
        1.6387169361114502
      ],
      "bar_heights": [
        10,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        10
      ],
      "title": "Top 10 negative and positive output logits",
      "x_label": "Logit Effect",
      "y_label": "Count"
    }
  }
};
        
        // Initialize the visualization
        let currentFeature = null;
        
        function init() {
            const select = document.getElementById('feature-select');
            const featureIndices = Object.keys(FEATURE_DATA).map(Number).sort((a, b) => a - b);
            
            if (featureIndices.length > 0) {
                currentFeature = featureIndices[0];
                select.value = currentFeature;
                displayFeature(currentFeature);
            }
            
            select.addEventListener('change', (e) => {
                currentFeature = parseInt(e.target.value);
                displayFeature(currentFeature);
            });
        }
        
        function displayFeature(featureIdx) {
            const data = FEATURE_DATA[featureIdx];
            if (!data) return;
            
            const content = document.getElementById('feature-content');
            content.innerHTML = generateFeatureHTML(data);
            
            // Render histograms after DOM is updated
            setTimeout(() => {
                renderHistograms(data);
            }, 100);
        }
        
        function renderHistograms(data) {
            // Render activation histogram
            renderActivationHistogram(data.activation_histogram);
            
            // Render logit histogram  
            renderLogitHistogram(data.logit_histogram);
        }
        
        function renderActivationHistogram(histData) {
            const container = document.getElementById('activation-histogram');
            if (!container || !histData.bar_heights.length) return;
            
            // Calculate bin width for narrower bars
            const binWidths = [];
            for (let i = 0; i < histData.bin_edges.length - 1; i++) {
                binWidths.push(histData.bin_edges[i + 1] - histData.bin_edges[i]);
            }
            const avgBinWidth = binWidths.reduce((a, b) => a + b, 0) / binWidths.length;
            
            // Create bin centers for x-axis
            const binCenters = [];
            for (let i = 0; i < histData.bin_edges.length - 1; i++) {
                binCenters.push((histData.bin_edges[i] + histData.bin_edges[i + 1]) / 2);
            }
            
            const trace = {
                x: binCenters,
                y: histData.bar_heights,
                type: 'bar',
                width: avgBinWidth * 0.8,  // Make bars 80% of bin width (narrower)
                marker: {
                    color: '#3498db',
                    opacity: 0.7,
                    line: {
                        color: '#2980b9',
                        width: 0.5
                    }
                },
                name: 'Activations'
            };
            
            const layout = {
                title: {
                    text: histData.title,
                    font: { size: 14 }
                },
                xaxis: {
                    title: histData.x_label,
                    showgrid: true,
                    gridcolor: '#e0e0e0',
                    zeroline: false,
                    range: [0, 10]  // Fixed x-axis from 0 to 10
                },
                yaxis: {
                    title: histData.y_label,
                    showgrid: true,
                    gridcolor: '#e0e0e0',
                    zeroline: false,
                    rangemode: 'tozero'  // Y-axis starts at 0
                },
                margin: { l: 50, r: 30, t: 50, b: 50 },
                height: 300,
                paper_bgcolor: 'white',
                plot_bgcolor: 'white',
                bargap: 0.1  // Small gap between bars for clean look
            };
            
            const config = {
                responsive: true,
                displayModeBar: false
            };
            
            Plotly.newPlot(container, [trace], layout, config);
        }
        
        function renderLogitHistogram(histData) {
            const container = document.getElementById('logit-histogram');
            if (!container || !histData.bar_heights.length) return;
            
            // Calculate bin width for narrower bars
            const binWidths = [];
            for (let i = 0; i < histData.bin_edges.length - 1; i++) {
                binWidths.push(histData.bin_edges[i + 1] - histData.bin_edges[i]);
            }
            const avgBinWidth = binWidths.reduce((a, b) => a + b, 0) / binWidths.length;
            
            // Create bin centers for x-axis
            const binCenters = [];
            for (let i = 0; i < histData.bin_edges.length - 1; i++) {
                binCenters.push((histData.bin_edges[i] + histData.bin_edges[i + 1]) / 2);
            }
            
            const trace = {
                x: binCenters,
                y: histData.bar_heights,
                type: 'bar',
                width: avgBinWidth * 0.8,  // Make bars 80% of bin width (narrower)
                marker: {
                    color: '#e74c3c',
                    opacity: 0.7,
                    line: {
                        color: '#c0392b',
                        width: 0.5
                    }
                },
                name: 'Logit Effects'
            };
            
            const layout = {
                title: {
                    text: histData.title,
                    font: { size: 14 }
                },
                xaxis: {
                    title: histData.x_label,
                    showgrid: true,
                    gridcolor: '#e0e0e0',
                    zeroline: true,
                    zerolinecolor: '#666',
                    zerolinewidth: 1
                },
                yaxis: {
                    title: histData.y_label,
                    showgrid: true,
                    gridcolor: '#e0e0e0',
                    zeroline: false
                },
                margin: { l: 50, r: 30, t: 50, b: 50 },
                height: 300,
                paper_bgcolor: 'white',
                plot_bgcolor: 'white',
                bargap: 0.1  // Small gap between bars for clean look
            };
            
            const config = {
                responsive: true,
                displayModeBar: false
            };
            
            Plotly.newPlot(container, [trace], layout, config);
        }
        
        function generateFeatureHTML(data) {
            return `
                <div class="feature-stats">
                    <div class="stat-item">
                        <div class="stat-label">Feature Index</div>
                        <div class="stat-value">${data.feature_idx}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Sparsity</div>
                        <div class="stat-value">${(data.sparsity * 100).toFixed(2)}%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Mean Activation</div>
                        <div class="stat-value">${data.mean_activation.toFixed(3)}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Max Activation</div>
                        <div class="stat-value">${data.max_activation.toFixed(3)}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Decoder Norm</div>
                        <div class="stat-value">${data.decoder_norm.toFixed(3)}</div>
                    </div>
                </div>
                
                <div class="section">
                    <h2>📊 Feature Analysis</h2>
                    <div class="histograms-grid">
                        <div class="histogram-container">
                            <h3>Activation Distribution</h3>
                            <div id="activation-histogram" class="histogram"></div>
                        </div>
                        <div class="histogram-container">
                            <h3>Logit Effects</h3>
                            <div id="logit-histogram" class="histogram"></div>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h2>Top Activating Examples</h2>
                    <div class="examples-grid">
                        ${data.top_examples.map(generateExampleHTML).join('')}
                    </div>
                </div>
                
                <div class="section">
                    <h2>Logit Effects</h2>
                    <div class="logits-grid">
                        <div class="logits-column boosted">
                            <h3>↑ Promoted Tokens</h3>
                            <ul class="token-list">
                                ${data.top_boosted_tokens.map(([token, effect]) => 
                                    `<li><span>"${escapeHtml(token)}"</span><span class="token-effect">+${effect.toFixed(3)}</span></li>`
                                ).join('')}
                            </ul>
                        </div>
                        <div class="logits-column suppressed">
                            <h3>↓ Suppressed Tokens</h3>
                            <ul class="token-list">
                                ${data.top_suppressed_tokens.map(([token, effect]) => 
                                    `<li><span>"${escapeHtml(token)}"</span><span class="token-effect">${effect.toFixed(3)}</span></li>`
                                ).join('')}
                            </ul>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function generateExampleHTML(example) {
            const maxAct = example.max_activation;
            const threshold1 = maxAct * 0.3;
            const threshold2 = maxAct * 0.6;
            
            const tokenHTML = example.tokens.map((token, i) => {
                const activation = example.activations[i] || 0;
                let className = 'token';
                
                if (activation > threshold2) {
                    className += ' active';
                } else if (activation > threshold1) {
                    className += ' medium';
                } else if (activation > 0) {
                    className += ' low';
                }
                
                return `<span class="${className}" title="Activation: ${activation.toFixed(4)}">${escapeHtml(token)}</span>`;
            }).join('');
            
            return `
                <div class="example">
                    <div class="example-header">
                        Max activation: ${maxAct.toFixed(4)} at position ${example.seq_pos}
                    </div>
                    <div class="token-sequence">
                        ${tokenHTML}
                    </div>
                </div>
            `;
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', init);
        
    </script>
</body>
</html>
